<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>pwm module</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
  </head>
  <body>
    <article class="markdown-body"><h1 id="pwm-module"><a class="header-link" href="#pwm-module"></a>pwm module</h1>
<p>This module contains functions for accessing the CPU&#39;s PWM (Pulse Width 
Modulation).</p>
<p>In the whitecat you have up-to 9 PWM channels, from 1 to 9.</p>
<p>PWM module can be set up in 2 modes:</p>
<ul class="list">
<li><p>DEFAULT: in this mode PWM is set up using the pulse frequency expressed in 
kilohertz and the initial duty value.</p>
</li>
<li><p>DAC: in this mode PWM is set up in Digital to Analog Converter mode, using 
the resolution bits to use and the initial DAC value.</p>
</li>
</ul>
<h2 id="pwm-setup-id-mode-frequency-resolution-bits-initial-duty-initial-value-"><a class="header-link" href="#pwm-setup-id-mode-frequency-resolution-bits-initial-duty-initial-value-"></a>pwm.setup(id, mode, [frequency / resolution bits], [initial duty / initial value])</h2>
<p>Setup the PWM module.</p>
<p>Arguments:</p>
<ul class="list">
<li>id: PWM channel</li>
<li><p>mode: setup mode, can be either pwm.DEFAULT or pwm.DAC</p>
<p>  For DEFAULT setup:</p>
<pre class="hljs"><code>  * frequency: pulse frequency, expressed <span class="hljs-operator">in</span> kilohertz
  * initial duty: initial duty <span class="hljs-built_in">value</span>, <span class="hljs-operator">a</span> decimal <span class="hljs-built_in">number</span> beetween <span class="hljs-number">0</span> <span class="hljs-operator">and</span> <span class="hljs-number">1</span>, </code></pre><p>where 0 is 0%, and 1 is 100%.</p>
<p>  For DAC setup:</p>
<pre class="hljs"><code>  * resulution bits: <span class="hljs-operator">the</span> desired DAC resolution bits, <span class="hljs-keyword">for</span> example <span class="hljs-number">12.</span>
  * initial <span class="hljs-built_in">value</span>: initial <span class="hljs-built_in">value</span> <span class="hljs-keyword">for</span> <span class="hljs-operator">the</span> DAC, <span class="hljs-operator">an</span> <span class="hljs-keyword">integer</span> <span class="hljs-built_in">number</span> beetween </code></pre><p>0 and 2 ^ (resolution bits) - 1.</p>
</li>
</ul>
<p>Returns: the real pulse frequency expressed in kilohertz.</p>
<pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel at 10 Khz, with initial duty value of 50%.</span>
freq = pwm.setup(led3, pwm.DEFAULT, <span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>)</code></pre><pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel at 12 bit-resolution, with initial value of 2047.</span>
<span class="hljs-comment">-- This generate a voltage of 50% of the voltage reference in the related pin.</span>
freq = pwm.setup(led3, pwm.DAC, <span class="hljs-number">12</span>, <span class="hljs-number">2047</span>)</code></pre><h2 id="pwm-start-id-"><a class="header-link" href="#pwm-start-id-"></a>pwm.start(id)</h2>
<p>Start the PWM channel.</p>
<p>Arguments:</p>
<p>id: PWM channel</p>
<p>Returns: nothing.</p>
<pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel at 10 Khz, with initial duty value of 50%.</span>
freq = pwm.setup(led3, pwm.DEFAULT, <span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>)

<span class="hljs-comment">-- Start PWM channel</span>
pwm.start(<span class="hljs-number">3</span>)</code></pre><h2 id="pwm-stop-id-"><a class="header-link" href="#pwm-stop-id-"></a>pwm.stop(id)</h2>
<p>Stop the PWM channel.
`
Arguments:</p>
<p>id: PWM channel</p>
<p>Returns: nothing.</p>
<pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel al 10 Khz, with initial duty value of 50%.</span>
freq = pwm.setup(led3, pwm.DEFAULT, <span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>)


<span class="hljs-comment">-- Do something with the PWM</span>
....


<span class="hljs-comment">-- Stop PWM channel</span>
pwm.stop(<span class="hljs-number">3</span>)</code></pre><h2 id="pwm-setduty-id-value-"><a class="header-link" href="#pwm-setduty-id-value-"></a>pwm.setduty(id, value)</h2>
<p>Set a new duty value. This function is only available if PWM channel is setup 
in DEFAULT mode.</p>
<p>Arguments:</p>
<ul class="list">
<li>id: PWM channel</li>
<li>value: new duty value, a decimal number beetween 0 and 1, 
where 0 is 0%, and 1 is 100%.</li>
</ul>
<p>Returns: nothing.</p>
<pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel at 10 Khz, with initial duty value of 50%.</span>
freq = pwm.setup(led3, pwm.DEFAULT, <span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>)

<span class="hljs-comment">-- Start PWM channel</span>
pwm.start(<span class="hljs-number">3</span>)

<span class="hljs-comment">-- Now duty value is 50%</span>

<span class="hljs-comment">-- Do something</span>
....

<span class="hljs-comment">-- Set new duty value (20%)</span>
pwm.setduty(<span class="hljs-number">3</span>, <span class="hljs-number">0.2</span>)

<span class="hljs-comment">-- Do something</span>
....

<span class="hljs-comment">-- Stop PWM channel</span>
pwm.stop(<span class="hljs-number">3</span>)</code></pre><h2 id="pwm-write-id-value-"><a class="header-link" href="#pwm-write-id-value-"></a>pwm.write(id, value)</h2>
<p>Set a new value on the DAC. This function is only available if PWM channel is 
setup in DAC mode.</p>
<p>Arguments:</p>
<ul class="list">
<li>id: PWM channel</li>
<li>value: new value for the DAC, an integer number beetween 0 and 
2 ^ (resolution bits) - 1.</li>
</ul>
<p>Returns: nothing.</p>
<pre class="hljs"><code><span class="hljs-comment">-- Setup PWM's 3 channel at 12 bit-resolution, with initial value of 2047.</span>
<span class="hljs-comment">-- This generate a voltage of 50% of the voltage reference in the related pin.</span>
freq = pwm.setup(led3, pwm.DAC, <span class="hljs-number">12</span>, <span class="hljs-number">2047</span>)

<span class="hljs-comment">-- Start PWM channel</span>
pwm.start(<span class="hljs-number">3</span>)

<span class="hljs-comment">-- Now duty value is 50%</span>

<span class="hljs-comment">-- Do something</span>
....

<span class="hljs-comment">-- Set new DAC value</span>
pwm.write(<span class="hljs-number">3</span>, <span class="hljs-number">4095</span>)

<span class="hljs-comment">-- Do something</span>
....

<span class="hljs-comment">-- Stop PWM channel</span>
pwm.stop(<span class="hljs-number">3</span>)</code></pre>    </article>
  </body>
</html>
